2024-12-22 23:34:03,396 - INFO - Loading data from ../data/processed/merged_data_2019_2022.csv
2024-12-22 23:34:06,365 - INFO - Data loaded successfully
2024-12-22 23:34:06,952 - INFO - Building pipeline for RandomForestClassifier()...
2024-12-22 23:34:06,952 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-22 23:34:07,028 - INFO - Identifying column types...
2024-12-22 23:34:07,152 - INFO - Building imputer...
2024-12-22 23:34:07,157 - INFO - Imputer built successfully.
2024-12-22 23:34:07,238 - INFO - Building encoder...
2024-12-22 23:34:07,243 - INFO - Encoder built successfully.
2024-12-22 23:34:07,268 - INFO - Pipeline built successfully.
2024-12-22 23:34:07,435 - INFO - Starting model training for RandomForest...
2024-12-22 23:34:12,490 - ERROR - Error during model training.
2024-12-22 23:34:12,491 - ERROR - Traceback (most recent call last):
  File "E:\Telechargements\Datascientest\Git_GitHub\repos\Projet_Accidentologie\src\models\trainer.py", line 44, in train_model
    search.fit(X_train, y_train)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_search.py", line 1023, in fit
    self._run_search(evaluate_candidates)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_search.py", line 1950, in _run_search
    evaluate_candidates(
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_search.py", line 1000, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 15 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
15 fits failed with the following error:
Traceback (most recent call last):
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_indexing.py", line 341, in _get_column_indices
    all_columns = X.columns
AttributeError: 'numpy.ndarray' object has no attribute 'columns'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 329, in fit
    Xt, yt = self._fit(X, y, routed_params)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 255, in _fit
    X, fitted_transformer = fit_transform_one_cached(
  File "F:\Anaconda\envs\conda_env\lib\site-packages\joblib\memory.py", line 312, in __call__
    return self.func(*args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 1104, in _fit_transform_one
    res = transformer.fit_transform(X, y, **params.get("fit_transform", {}))
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\compose\_column_transformer.py", line 992, in fit_transform
    self._validate_column_callables(X)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\compose\_column_transformer.py", line 551, in _validate_column_callables
    transformer_to_input_indices[name] = _get_column_indices(X, columns)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_indexing.py", line 343, in _get_column_indices
    raise ValueError(
ValueError: Specifying the columns using strings is only supported for dataframes.


2024-12-22 23:34:12,511 - ERROR - Error processing model RandomForest: 
All the 15 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
15 fits failed with the following error:
Traceback (most recent call last):
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_indexing.py", line 341, in _get_column_indices
    all_columns = X.columns
AttributeError: 'numpy.ndarray' object has no attribute 'columns'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 329, in fit
    Xt, yt = self._fit(X, y, routed_params)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 255, in _fit
    X, fitted_transformer = fit_transform_one_cached(
  File "F:\Anaconda\envs\conda_env\lib\site-packages\joblib\memory.py", line 312, in __call__
    return self.func(*args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 1104, in _fit_transform_one
    res = transformer.fit_transform(X, y, **params.get("fit_transform", {}))
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\compose\_column_transformer.py", line 992, in fit_transform
    self._validate_column_callables(X)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\compose\_column_transformer.py", line 551, in _validate_column_callables
    transformer_to_input_indices[name] = _get_column_indices(X, columns)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_indexing.py", line 343, in _get_column_indices
    raise ValueError(
ValueError: Specifying the columns using strings is only supported for dataframes.

2024-12-22 23:34:12,679 - INFO - Building pipeline for XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=None,
              num_parallel_tree=None, random_state=None, ...)...
2024-12-22 23:34:12,679 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-22 23:34:12,752 - INFO - Identifying column types...
2024-12-22 23:34:12,892 - INFO - Building imputer...
2024-12-22 23:34:12,898 - INFO - Imputer built successfully.
2024-12-22 23:34:12,981 - INFO - Building encoder...
2024-12-22 23:34:12,986 - INFO - Encoder built successfully.
2024-12-22 23:34:13,009 - INFO - Pipeline built successfully.
2024-12-22 23:34:13,188 - INFO - Starting model training for XGBoost...
2024-12-22 23:34:14,731 - ERROR - Error during model training.
2024-12-22 23:34:14,732 - ERROR - Traceback (most recent call last):
  File "E:\Telechargements\Datascientest\Git_GitHub\repos\Projet_Accidentologie\src\models\trainer.py", line 44, in train_model
    search.fit(X_train, y_train)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_search.py", line 1023, in fit
    self._run_search(evaluate_candidates)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_search.py", line 1950, in _run_search
    evaluate_candidates(
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_search.py", line 1000, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 15 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
15 fits failed with the following error:
Traceback (most recent call last):
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_indexing.py", line 341, in _get_column_indices
    all_columns = X.columns
AttributeError: 'numpy.ndarray' object has no attribute 'columns'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 329, in fit
    Xt, yt = self._fit(X, y, routed_params)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 255, in _fit
    X, fitted_transformer = fit_transform_one_cached(
  File "F:\Anaconda\envs\conda_env\lib\site-packages\joblib\memory.py", line 312, in __call__
    return self.func(*args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 1104, in _fit_transform_one
    res = transformer.fit_transform(X, y, **params.get("fit_transform", {}))
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\compose\_column_transformer.py", line 992, in fit_transform
    self._validate_column_callables(X)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\compose\_column_transformer.py", line 551, in _validate_column_callables
    transformer_to_input_indices[name] = _get_column_indices(X, columns)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_indexing.py", line 343, in _get_column_indices
    raise ValueError(
ValueError: Specifying the columns using strings is only supported for dataframes.


2024-12-22 23:34:14,751 - ERROR - Error processing model XGBoost: 
All the 15 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
15 fits failed with the following error:
Traceback (most recent call last):
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_indexing.py", line 341, in _get_column_indices
    all_columns = X.columns
AttributeError: 'numpy.ndarray' object has no attribute 'columns'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 329, in fit
    Xt, yt = self._fit(X, y, routed_params)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 255, in _fit
    X, fitted_transformer = fit_transform_one_cached(
  File "F:\Anaconda\envs\conda_env\lib\site-packages\joblib\memory.py", line 312, in __call__
    return self.func(*args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 1104, in _fit_transform_one
    res = transformer.fit_transform(X, y, **params.get("fit_transform", {}))
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\compose\_column_transformer.py", line 992, in fit_transform
    self._validate_column_callables(X)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\compose\_column_transformer.py", line 551, in _validate_column_callables
    transformer_to_input_indices[name] = _get_column_indices(X, columns)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_indexing.py", line 343, in _get_column_indices
    raise ValueError(
ValueError: Specifying the columns using strings is only supported for dataframes.

2024-12-22 23:34:14,947 - INFO - Building pipeline for LGBMClassifier()...
2024-12-22 23:34:14,947 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-22 23:34:15,030 - INFO - Identifying column types...
2024-12-22 23:34:15,179 - INFO - Building imputer...
2024-12-22 23:34:15,184 - INFO - Imputer built successfully.
2024-12-22 23:34:15,262 - INFO - Building encoder...
2024-12-22 23:34:15,267 - INFO - Encoder built successfully.
2024-12-22 23:34:15,290 - INFO - Pipeline built successfully.
2024-12-22 23:34:15,448 - INFO - Starting model training for LightGBM...
2024-12-22 23:34:17,187 - ERROR - Error during model training.
2024-12-22 23:34:17,188 - ERROR - Traceback (most recent call last):
  File "E:\Telechargements\Datascientest\Git_GitHub\repos\Projet_Accidentologie\src\models\trainer.py", line 44, in train_model
    search.fit(X_train, y_train)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_search.py", line 1023, in fit
    self._run_search(evaluate_candidates)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_search.py", line 1950, in _run_search
    evaluate_candidates(
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_search.py", line 1000, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 15 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
15 fits failed with the following error:
Traceback (most recent call last):
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_indexing.py", line 341, in _get_column_indices
    all_columns = X.columns
AttributeError: 'numpy.ndarray' object has no attribute 'columns'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 329, in fit
    Xt, yt = self._fit(X, y, routed_params)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 255, in _fit
    X, fitted_transformer = fit_transform_one_cached(
  File "F:\Anaconda\envs\conda_env\lib\site-packages\joblib\memory.py", line 312, in __call__
    return self.func(*args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 1104, in _fit_transform_one
    res = transformer.fit_transform(X, y, **params.get("fit_transform", {}))
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\compose\_column_transformer.py", line 992, in fit_transform
    self._validate_column_callables(X)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\compose\_column_transformer.py", line 551, in _validate_column_callables
    transformer_to_input_indices[name] = _get_column_indices(X, columns)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_indexing.py", line 343, in _get_column_indices
    raise ValueError(
ValueError: Specifying the columns using strings is only supported for dataframes.


2024-12-22 23:34:17,207 - ERROR - Error processing model LightGBM: 
All the 15 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
15 fits failed with the following error:
Traceback (most recent call last):
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_indexing.py", line 341, in _get_column_indices
    all_columns = X.columns
AttributeError: 'numpy.ndarray' object has no attribute 'columns'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 329, in fit
    Xt, yt = self._fit(X, y, routed_params)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 255, in _fit
    X, fitted_transformer = fit_transform_one_cached(
  File "F:\Anaconda\envs\conda_env\lib\site-packages\joblib\memory.py", line 312, in __call__
    return self.func(*args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 1104, in _fit_transform_one
    res = transformer.fit_transform(X, y, **params.get("fit_transform", {}))
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\compose\_column_transformer.py", line 992, in fit_transform
    self._validate_column_callables(X)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\compose\_column_transformer.py", line 551, in _validate_column_callables
    transformer_to_input_indices[name] = _get_column_indices(X, columns)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_indexing.py", line 343, in _get_column_indices
    raise ValueError(
ValueError: Specifying the columns using strings is only supported for dataframes.

2024-12-22 23:34:17,358 - INFO - Building pipeline for LogisticRegression()...
2024-12-22 23:34:17,358 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-22 23:34:17,440 - INFO - Identifying column types...
2024-12-22 23:34:17,578 - INFO - Building imputer...
2024-12-22 23:34:17,584 - INFO - Imputer built successfully.
2024-12-22 23:34:17,671 - INFO - Building encoder...
2024-12-22 23:34:17,676 - INFO - Encoder built successfully.
2024-12-22 23:34:17,699 - INFO - Pipeline built successfully.
2024-12-22 23:34:18,207 - INFO - Starting model training for LogisticRegression...
2024-12-22 23:34:19,710 - ERROR - Error during model training.
2024-12-22 23:34:19,710 - ERROR - Traceback (most recent call last):
  File "E:\Telechargements\Datascientest\Git_GitHub\repos\Projet_Accidentologie\src\models\trainer.py", line 44, in train_model
    search.fit(X_train, y_train)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_search.py", line 1023, in fit
    self._run_search(evaluate_candidates)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_search.py", line 1950, in _run_search
    evaluate_candidates(
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_search.py", line 1000, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 15 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
15 fits failed with the following error:
Traceback (most recent call last):
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_indexing.py", line 341, in _get_column_indices
    all_columns = X.columns
AttributeError: 'numpy.ndarray' object has no attribute 'columns'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 329, in fit
    Xt, yt = self._fit(X, y, routed_params)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 255, in _fit
    X, fitted_transformer = fit_transform_one_cached(
  File "F:\Anaconda\envs\conda_env\lib\site-packages\joblib\memory.py", line 312, in __call__
    return self.func(*args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 1104, in _fit_transform_one
    res = transformer.fit_transform(X, y, **params.get("fit_transform", {}))
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\compose\_column_transformer.py", line 992, in fit_transform
    self._validate_column_callables(X)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\compose\_column_transformer.py", line 551, in _validate_column_callables
    transformer_to_input_indices[name] = _get_column_indices(X, columns)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_indexing.py", line 343, in _get_column_indices
    raise ValueError(
ValueError: Specifying the columns using strings is only supported for dataframes.


2024-12-22 23:34:19,732 - ERROR - Error processing model LogisticRegression: 
All the 15 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
15 fits failed with the following error:
Traceback (most recent call last):
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_indexing.py", line 341, in _get_column_indices
    all_columns = X.columns
AttributeError: 'numpy.ndarray' object has no attribute 'columns'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 329, in fit
    Xt, yt = self._fit(X, y, routed_params)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 255, in _fit
    X, fitted_transformer = fit_transform_one_cached(
  File "F:\Anaconda\envs\conda_env\lib\site-packages\joblib\memory.py", line 312, in __call__
    return self.func(*args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\imblearn\pipeline.py", line 1104, in _fit_transform_one
    res = transformer.fit_transform(X, y, **params.get("fit_transform", {}))
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\compose\_column_transformer.py", line 992, in fit_transform
    self._validate_column_callables(X)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\compose\_column_transformer.py", line 551, in _validate_column_callables
    transformer_to_input_indices[name] = _get_column_indices(X, columns)
  File "F:\Anaconda\envs\conda_env\lib\site-packages\sklearn\utils\_indexing.py", line 343, in _get_column_indices
    raise ValueError(
ValueError: Specifying the columns using strings is only supported for dataframes.

2024-12-22 23:34:19,746 - INFO - Empty DataFrame
Columns: []
Index: []
2024-12-22 23:38:43,174 - INFO - Loading data from ../data/processed/merged_data_2019_2022.csv
2024-12-22 23:38:46,213 - INFO - Data loaded successfully
2024-12-22 23:38:46,801 - INFO - Building pipeline for RandomForestClassifier()...
2024-12-22 23:38:46,801 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-22 23:38:46,876 - INFO - Identifying column types...
2024-12-22 23:38:46,884 - DEBUG - Numerical columns detected: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:38:46,884 - DEBUG - Categorical columns detected: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:38:47,001 - INFO - Building preprocessor...
2024-12-22 23:38:47,002 - DEBUG - Numerical columns: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:38:47,002 - DEBUG - Categorical columns: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:38:47,007 - INFO - Preprocessor built successfully.
2024-12-22 23:38:47,035 - INFO - Pipeline built successfully.
2024-12-22 23:38:47,191 - INFO - Starting model training for RandomForest...
2024-12-22 23:39:14,765 - INFO - Training completed in 27.57 seconds
2024-12-22 23:39:14,765 - INFO - Best parameters: {'classifier__n_estimators': 300, 'classifier__min_samples_split': 10, 'classifier__min_samples_leaf': 1, 'classifier__max_depth': None, 'classifier__class_weight': 'balanced'}
2024-12-22 23:39:30,296 - INFO - Evaluating model: RandomForest
2024-12-22 23:39:30,767 - INFO - Calculating metrics...
2024-12-22 23:39:30,922 - INFO - F1-score: 0.7747
2024-12-22 23:39:30,922 - INFO - Cohen Kappa: 0.3965
2024-12-22 23:39:30,922 - INFO - MCC: 0.4459
2024-12-22 23:39:30,922 - INFO - Recall: 0.7477
2024-12-22 23:39:30,922 - INFO - Balanced Accuracy: 0.7801
2024-12-22 23:39:30,962 - INFO - ROC AUC: 0.8577
2024-12-22 23:39:30,962 - INFO - Log Loss: 0.4829
2024-12-22 23:39:30,962 - INFO - Brier Score: 0.1614
2024-12-22 23:39:30,962 - INFO - Logging metrics to MLflow...
2024-12-22 23:39:30,967 - INFO - Logged f1_score: 0.7747156313792244
2024-12-22 23:39:30,972 - INFO - Logged cohen_kappa: 0.39652307953782007
2024-12-22 23:39:30,977 - INFO - Logged mcc: 0.4458563009627951
2024-12-22 23:39:30,982 - INFO - Logged recall: 0.7477148080438757
2024-12-22 23:39:30,987 - INFO - Logged balanced_accuracy: 0.7800667749327566
2024-12-22 23:39:30,993 - INFO - Logged roc_auc: 0.8577084238416653
2024-12-22 23:39:30,998 - INFO - Logged log_loss: 0.4829306496210806
2024-12-22 23:39:31,003 - INFO - Logged brier_score: 0.16138959271708728
2024-12-22 23:39:31,004 - INFO - Logging artifacts...
2024-12-22 23:39:39,108 - INFO - Model evaluation completed in 8.81 seconds
2024-12-22 23:39:42,820 - INFO - Model RandomForest evaluated with params {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}, threshold 0.5, scoring f1.
2024-12-22 23:39:43,037 - INFO - Building pipeline for XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=None,
              num_parallel_tree=None, random_state=None, ...)...
2024-12-22 23:39:43,038 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-22 23:39:43,112 - INFO - Identifying column types...
2024-12-22 23:39:43,128 - DEBUG - Numerical columns detected: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:39:43,128 - DEBUG - Categorical columns detected: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:39:43,239 - INFO - Building preprocessor...
2024-12-22 23:39:43,239 - DEBUG - Numerical columns: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:39:43,239 - DEBUG - Categorical columns: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:39:43,244 - INFO - Preprocessor built successfully.
2024-12-22 23:39:43,272 - INFO - Pipeline built successfully.
2024-12-22 23:39:43,426 - INFO - Starting model training for XGBoost...
2024-12-22 23:40:00,528 - INFO - Training completed in 17.10 seconds
2024-12-22 23:40:00,528 - INFO - Best parameters: {'classifier__subsample': 0.5, 'classifier__n_estimators': 100, 'classifier__max_depth': 6, 'classifier__learning_rate': 0.1, 'classifier__colsample_bytree': 0.5, 'classifier__class_weight': {'0': 1, '1': 5}}
2024-12-22 23:40:04,552 - INFO - Evaluating model: XGBoost
2024-12-22 23:40:04,643 - INFO - Calculating metrics...
2024-12-22 23:40:04,686 - INFO - F1-score: 0.7811
2024-12-22 23:40:04,686 - INFO - Cohen Kappa: 0.4026
2024-12-22 23:40:04,686 - INFO - MCC: 0.4466
2024-12-22 23:40:04,686 - INFO - Recall: 0.7557
2024-12-22 23:40:04,686 - INFO - Balanced Accuracy: 0.7782
2024-12-22 23:40:04,748 - INFO - ROC AUC: 0.8572
2024-12-22 23:40:04,748 - INFO - Log Loss: 0.4794
2024-12-22 23:40:04,748 - INFO - Brier Score: 0.1602
2024-12-22 23:40:04,748 - INFO - Logging metrics to MLflow...
2024-12-22 23:40:04,754 - INFO - Logged f1_score: 0.7811088293607148
2024-12-22 23:40:04,762 - INFO - Logged cohen_kappa: 0.4026434650570482
2024-12-22 23:40:04,771 - INFO - Logged mcc: 0.44655461133327734
2024-12-22 23:40:04,777 - INFO - Logged recall: 0.7557383709120455
2024-12-22 23:40:04,783 - INFO - Logged balanced_accuracy: 0.7781661696725193
2024-12-22 23:40:04,789 - INFO - Logged roc_auc: 0.857160598634888
2024-12-22 23:40:04,794 - INFO - Logged log_loss: 0.4793667157101297
2024-12-22 23:40:04,800 - INFO - Logged brier_score: 0.16016963764687003
2024-12-22 23:40:04,800 - INFO - Logging artifacts...
2024-12-22 23:40:05,181 - INFO - Model evaluation completed in 0.63 seconds
2024-12-22 23:40:08,660 - INFO - Model XGBoost evaluated with params {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}, threshold 0.5, scoring f1.
2024-12-22 23:40:08,821 - INFO - Building pipeline for LGBMClassifier()...
2024-12-22 23:40:08,821 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-22 23:40:08,896 - INFO - Identifying column types...
2024-12-22 23:40:08,913 - DEBUG - Numerical columns detected: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:40:08,913 - DEBUG - Categorical columns detected: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:40:09,029 - INFO - Building preprocessor...
2024-12-22 23:40:09,029 - DEBUG - Numerical columns: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:40:09,029 - DEBUG - Categorical columns: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:40:09,035 - INFO - Preprocessor built successfully.
2024-12-22 23:40:09,071 - INFO - Pipeline built successfully.
2024-12-22 23:40:09,239 - INFO - Starting model training for LightGBM...
2024-12-22 23:40:26,579 - INFO - Training completed in 17.34 seconds
2024-12-22 23:40:26,579 - INFO - Best parameters: {'classifier__num_leaves': 31, 'classifier__n_estimators': 100, 'classifier__max_depth': -1, 'classifier__learning_rate': 0.1, 'classifier__class_weight': 'balanced'}
2024-12-22 23:40:30,293 - INFO - Evaluating model: LightGBM
2024-12-22 23:40:30,373 - INFO - Calculating metrics...
2024-12-22 23:40:30,384 - INFO - F1-score: 0.7780
2024-12-22 23:40:30,385 - INFO - Cohen Kappa: 0.4020
2024-12-22 23:40:30,385 - INFO - MCC: 0.4501
2024-12-22 23:40:30,385 - INFO - Recall: 0.7517
2024-12-22 23:40:30,385 - INFO - Balanced Accuracy: 0.7820
2024-12-22 23:40:30,390 - INFO - ROC AUC: 0.8571
2024-12-22 23:40:30,391 - INFO - Log Loss: 0.4816
2024-12-22 23:40:30,391 - INFO - Brier Score: 0.1616
2024-12-22 23:40:30,391 - INFO - Logging metrics to MLflow...
2024-12-22 23:40:30,397 - INFO - Logged f1_score: 0.7780283175887579
2024-12-22 23:40:30,405 - INFO - Logged cohen_kappa: 0.4020071183436429
2024-12-22 23:40:30,410 - INFO - Logged mcc: 0.45010536057122497
2024-12-22 23:40:30,415 - INFO - Logged recall: 0.7516758074344911
2024-12-22 23:40:30,420 - INFO - Logged balanced_accuracy: 0.7820452475666619
2024-12-22 23:40:30,426 - INFO - Logged roc_auc: 0.8570996710748291
2024-12-22 23:40:30,432 - INFO - Logged log_loss: 0.48157406888929005
2024-12-22 23:40:30,437 - INFO - Logged brier_score: 0.16163627885221513
2024-12-22 23:40:30,438 - INFO - Logging artifacts...
2024-12-22 23:40:30,867 - INFO - Model evaluation completed in 0.57 seconds
2024-12-22 23:40:34,296 - INFO - Model LightGBM evaluated with params {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}, threshold 0.5, scoring f1.
2024-12-22 23:40:34,452 - INFO - Building pipeline for LogisticRegression()...
2024-12-22 23:40:34,452 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-22 23:40:34,531 - INFO - Identifying column types...
2024-12-22 23:40:34,549 - DEBUG - Numerical columns detected: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:40:34,549 - DEBUG - Categorical columns detected: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:40:34,677 - INFO - Building preprocessor...
2024-12-22 23:40:34,677 - DEBUG - Numerical columns: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:40:34,677 - DEBUG - Categorical columns: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:40:34,683 - INFO - Preprocessor built successfully.
2024-12-22 23:40:34,713 - INFO - Pipeline built successfully.
2024-12-22 23:40:34,885 - INFO - Starting model training for LogisticRegression...
2024-12-22 23:40:51,692 - INFO - Training completed in 16.81 seconds
2024-12-22 23:40:51,693 - INFO - Best parameters: {'classifier__solver': 'liblinear', 'classifier__penalty': 'l2', 'classifier__class_weight': 'balanced', 'classifier__C': 0.1}
2024-12-22 23:40:55,182 - INFO - Evaluating model: LogisticRegression
2024-12-22 23:40:55,302 - INFO - Calculating metrics...
2024-12-22 23:40:55,313 - INFO - F1-score: 0.7767
2024-12-22 23:40:55,313 - INFO - Cohen Kappa: 0.3832
2024-12-22 23:40:55,313 - INFO - MCC: 0.4213
2024-12-22 23:40:55,313 - INFO - Recall: 0.7515
2024-12-22 23:40:55,313 - INFO - Balanced Accuracy: 0.7609
2024-12-22 23:40:55,319 - INFO - ROC AUC: 0.8416
2024-12-22 23:40:55,319 - INFO - Log Loss: 0.4990
2024-12-22 23:40:55,320 - INFO - Brier Score: 0.1652
2024-12-22 23:40:55,320 - INFO - Logging metrics to MLflow...
2024-12-22 23:40:55,328 - INFO - Logged f1_score: 0.7766962849135455
2024-12-22 23:40:55,335 - INFO - Logged cohen_kappa: 0.3832074420732693
2024-12-22 23:40:55,342 - INFO - Logged mcc: 0.42132676782566714
2024-12-22 23:40:55,350 - INFO - Logged recall: 0.7514726792606135
2024-12-22 23:40:55,356 - INFO - Logged balanced_accuracy: 0.7608741055360146
2024-12-22 23:40:55,363 - INFO - Logged roc_auc: 0.8415578103555102
2024-12-22 23:40:55,369 - INFO - Logged log_loss: 0.49898358702783896
2024-12-22 23:40:55,377 - INFO - Logged brier_score: 0.16524634839687835
2024-12-22 23:40:55,377 - INFO - Logging artifacts...
2024-12-22 23:40:55,737 - INFO - Model evaluation completed in 0.56 seconds
2024-12-22 23:40:59,024 - INFO - Model LogisticRegression evaluated with params {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}, threshold 0.5, scoring f1.
2024-12-22 23:40:59,193 - INFO -                 model  decision_threshold  ...                                        best_params                                     feature_params
0        RandomForest                 0.5  ...  {'classifier__n_estimators': 300, 'classifier_...  {'variance_threshold': 0.01, 'importance_thres...
1             XGBoost                 0.5  ...  {'classifier__subsample': 0.5, 'classifier__n_...  {'variance_threshold': 0.01, 'importance_thres...
2            LightGBM                 0.5  ...  {'classifier__num_leaves': 31, 'classifier__n_...  {'variance_threshold': 0.01, 'importance_thres...
3  LogisticRegression                 0.5  ...  {'classifier__solver': 'liblinear', 'classifie...  {'variance_threshold': 0.01, 'importance_thres...

[4 rows x 6 columns]
2024-12-22 23:51:07,622 - INFO - Loading data from ../data/processed/merged_data_2019_2022.csv
2024-12-22 23:51:10,792 - INFO - Data loaded successfully
2024-12-22 23:51:11,355 - INFO - Building pipeline for RandomForestClassifier()...
2024-12-22 23:51:11,355 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-22 23:51:11,428 - INFO - Identifying column types...
2024-12-22 23:51:11,435 - DEBUG - Numerical columns detected: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:51:11,435 - DEBUG - Categorical columns detected: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:51:11,549 - INFO - Building preprocessor...
2024-12-22 23:51:11,549 - DEBUG - Numerical columns: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:51:11,549 - DEBUG - Categorical columns: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:51:11,554 - INFO - Preprocessor built successfully.
2024-12-22 23:51:11,586 - INFO - Pipeline built successfully.
2024-12-22 23:51:11,745 - INFO - Starting model training for RandomForest...
2024-12-22 23:51:40,113 - INFO - Training completed in 28.37 seconds
2024-12-22 23:51:40,113 - INFO - Best parameters: {'classifier__n_estimators': 300, 'classifier__min_samples_split': 10, 'classifier__min_samples_leaf': 1, 'classifier__max_depth': None, 'classifier__class_weight': 'balanced'}
2024-12-22 23:51:45,200 - INFO - Evaluating model: RandomForest
2024-12-22 23:51:45,652 - INFO - Calculating metrics...
2024-12-22 23:51:45,665 - INFO - F1-score: 0.7762
2024-12-22 23:51:45,665 - INFO - Cohen Kappa: 0.4002
2024-12-22 23:51:45,665 - INFO - MCC: 0.4498
2024-12-22 23:51:45,665 - INFO - Recall: 0.7494
2024-12-22 23:51:45,665 - INFO - Balanced Accuracy: 0.7824
2024-12-22 23:51:45,675 - INFO - ROC AUC: 0.8583
2024-12-22 23:51:45,675 - INFO - Log Loss: 0.4826
2024-12-22 23:51:45,675 - INFO - Brier Score: 0.1613
2024-12-22 23:51:45,675 - INFO - Logging metrics to MLflow...
2024-12-22 23:51:45,681 - INFO - Logged f1_score: 0.7762317695212302
2024-12-22 23:51:45,687 - INFO - Logged cohen_kappa: 0.40018769197200976
2024-12-22 23:51:45,692 - INFO - Logged mcc: 0.44975336759361134
2024-12-22 23:51:45,698 - INFO - Logged recall: 0.7494413975218363
2024-12-22 23:51:45,703 - INFO - Logged balanced_accuracy: 0.7824357695248432
2024-12-22 23:51:45,709 - INFO - Logged roc_auc: 0.8582965072474519
2024-12-22 23:51:45,714 - INFO - Logged log_loss: 0.48261011900016604
2024-12-22 23:51:45,719 - INFO - Logged brier_score: 0.16128592883105805
2024-12-22 23:51:45,719 - INFO - Logging artifacts...
2024-12-22 23:51:46,488 - INFO - Model evaluation completed in 1.29 seconds
2024-12-22 23:51:50,552 - INFO - Model RandomForest evaluated with params {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}, threshold 0.5, scoring f1.
2024-12-22 23:51:50,739 - INFO - Building pipeline for XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=None,
              num_parallel_tree=None, random_state=None, ...)...
2024-12-22 23:51:50,739 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-22 23:51:50,829 - INFO - Identifying column types...
2024-12-22 23:51:50,849 - DEBUG - Numerical columns detected: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:51:50,849 - DEBUG - Categorical columns detected: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:51:50,986 - INFO - Building preprocessor...
2024-12-22 23:51:50,986 - DEBUG - Numerical columns: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:51:50,986 - DEBUG - Categorical columns: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:51:50,991 - INFO - Preprocessor built successfully.
2024-12-22 23:51:51,022 - INFO - Pipeline built successfully.
2024-12-22 23:51:51,206 - INFO - Starting model training for XGBoost...
2024-12-22 23:52:10,068 - INFO - Training completed in 18.86 seconds
2024-12-22 23:52:10,068 - INFO - Best parameters: {'classifier__subsample': 0.5, 'classifier__n_estimators': 100, 'classifier__max_depth': 6, 'classifier__learning_rate': 0.1, 'classifier__colsample_bytree': 0.5, 'classifier__class_weight': {'0': 1, '1': 5}}
2024-12-22 23:52:13,859 - INFO - Evaluating model: XGBoost
2024-12-22 23:52:13,956 - INFO - Calculating metrics...
2024-12-22 23:52:13,972 - INFO - F1-score: 0.7811
2024-12-22 23:52:13,972 - INFO - Cohen Kappa: 0.4026
2024-12-22 23:52:13,972 - INFO - MCC: 0.4466
2024-12-22 23:52:13,972 - INFO - Recall: 0.7557
2024-12-22 23:52:13,972 - INFO - Balanced Accuracy: 0.7782
2024-12-22 23:52:13,981 - INFO - ROC AUC: 0.8572
2024-12-22 23:52:13,981 - INFO - Log Loss: 0.4794
2024-12-22 23:52:13,981 - INFO - Brier Score: 0.1602
2024-12-22 23:52:13,981 - INFO - Logging metrics to MLflow...
2024-12-22 23:52:13,991 - INFO - Logged f1_score: 0.7811088293607148
2024-12-22 23:52:13,999 - INFO - Logged cohen_kappa: 0.4026434650570482
2024-12-22 23:52:14,008 - INFO - Logged mcc: 0.44655461133327734
2024-12-22 23:52:14,017 - INFO - Logged recall: 0.7557383709120455
2024-12-22 23:52:14,027 - INFO - Logged balanced_accuracy: 0.7781661696725193
2024-12-22 23:52:14,036 - INFO - Logged roc_auc: 0.857160598634888
2024-12-22 23:52:14,047 - INFO - Logged log_loss: 0.4793667157101297
2024-12-22 23:52:14,055 - INFO - Logged brier_score: 0.16016963764687003
2024-12-22 23:52:14,055 - INFO - Logging artifacts...
2024-12-22 23:52:14,356 - INFO - Model evaluation completed in 0.50 seconds
2024-12-22 23:52:17,946 - INFO - Model XGBoost evaluated with params {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}, threshold 0.5, scoring f1.
2024-12-22 23:52:18,102 - INFO - Building pipeline for LGBMClassifier()...
2024-12-22 23:52:18,102 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-22 23:52:18,175 - INFO - Identifying column types...
2024-12-22 23:52:18,192 - DEBUG - Numerical columns detected: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:52:18,192 - DEBUG - Categorical columns detected: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:52:18,308 - INFO - Building preprocessor...
2024-12-22 23:52:18,308 - DEBUG - Numerical columns: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:52:18,308 - DEBUG - Categorical columns: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:52:18,314 - INFO - Preprocessor built successfully.
2024-12-22 23:52:18,344 - INFO - Pipeline built successfully.
2024-12-22 23:52:18,502 - INFO - Starting model training for LightGBM...
2024-12-22 23:52:37,558 - INFO - Training completed in 19.06 seconds
2024-12-22 23:52:37,558 - INFO - Best parameters: {'classifier__num_leaves': 31, 'classifier__n_estimators': 100, 'classifier__max_depth': -1, 'classifier__learning_rate': 0.1, 'classifier__class_weight': 'balanced'}
2024-12-22 23:52:41,353 - INFO - Evaluating model: LightGBM
2024-12-22 23:52:41,439 - INFO - Calculating metrics...
2024-12-22 23:52:41,448 - INFO - F1-score: 0.7780
2024-12-22 23:52:41,448 - INFO - Cohen Kappa: 0.4020
2024-12-22 23:52:41,448 - INFO - MCC: 0.4501
2024-12-22 23:52:41,448 - INFO - Recall: 0.7517
2024-12-22 23:52:41,448 - INFO - Balanced Accuracy: 0.7820
2024-12-22 23:52:41,458 - INFO - ROC AUC: 0.8571
2024-12-22 23:52:41,458 - INFO - Log Loss: 0.4816
2024-12-22 23:52:41,458 - INFO - Brier Score: 0.1616
2024-12-22 23:52:41,458 - INFO - Logging metrics to MLflow...
2024-12-22 23:52:41,465 - INFO - Logged f1_score: 0.7780283175887579
2024-12-22 23:52:41,474 - INFO - Logged cohen_kappa: 0.4020071183436429
2024-12-22 23:52:41,480 - INFO - Logged mcc: 0.45010536057122497
2024-12-22 23:52:41,489 - INFO - Logged recall: 0.7516758074344911
2024-12-22 23:52:41,496 - INFO - Logged balanced_accuracy: 0.7820452475666619
2024-12-22 23:52:41,505 - INFO - Logged roc_auc: 0.8570996710748291
2024-12-22 23:52:41,516 - INFO - Logged log_loss: 0.48157406888929005
2024-12-22 23:52:41,527 - INFO - Logged brier_score: 0.16163627885221513
2024-12-22 23:52:41,527 - INFO - Logging artifacts...
2024-12-22 23:52:41,806 - INFO - Model evaluation completed in 0.45 seconds
2024-12-22 23:52:45,387 - INFO - Model LightGBM evaluated with params {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}, threshold 0.5, scoring f1.
2024-12-22 23:52:45,588 - INFO - Building pipeline for LogisticRegression()...
2024-12-22 23:52:45,589 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-22 23:52:45,669 - INFO - Identifying column types...
2024-12-22 23:52:45,687 - DEBUG - Numerical columns detected: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:52:45,687 - DEBUG - Categorical columns detected: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:52:45,822 - INFO - Building preprocessor...
2024-12-22 23:52:45,822 - DEBUG - Numerical columns: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:52:45,823 - DEBUG - Categorical columns: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:52:45,827 - INFO - Preprocessor built successfully.
2024-12-22 23:52:45,863 - INFO - Pipeline built successfully.
2024-12-22 23:52:46,057 - INFO - Starting model training for LogisticRegression...
2024-12-22 23:53:04,131 - INFO - Training completed in 18.07 seconds
2024-12-22 23:53:04,131 - INFO - Best parameters: {'classifier__solver': 'liblinear', 'classifier__penalty': 'l2', 'classifier__class_weight': 'balanced', 'classifier__C': 0.1}
2024-12-22 23:53:07,755 - INFO - Evaluating model: LogisticRegression
2024-12-22 23:53:07,847 - INFO - Calculating metrics...
2024-12-22 23:53:07,862 - INFO - F1-score: 0.7767
2024-12-22 23:53:07,862 - INFO - Cohen Kappa: 0.3832
2024-12-22 23:53:07,862 - INFO - MCC: 0.4213
2024-12-22 23:53:07,862 - INFO - Recall: 0.7515
2024-12-22 23:53:07,863 - INFO - Balanced Accuracy: 0.7609
2024-12-22 23:53:07,869 - INFO - ROC AUC: 0.8416
2024-12-22 23:53:07,870 - INFO - Log Loss: 0.4990
2024-12-22 23:53:07,870 - INFO - Brier Score: 0.1652
2024-12-22 23:53:07,870 - INFO - Logging metrics to MLflow...
2024-12-22 23:53:07,877 - INFO - Logged f1_score: 0.7766962849135455
2024-12-22 23:53:07,885 - INFO - Logged cohen_kappa: 0.3832074420732693
2024-12-22 23:53:07,893 - INFO - Logged mcc: 0.42132676782566714
2024-12-22 23:53:07,902 - INFO - Logged recall: 0.7514726792606135
2024-12-22 23:53:07,908 - INFO - Logged balanced_accuracy: 0.7608741055360146
2024-12-22 23:53:07,913 - INFO - Logged roc_auc: 0.8415578103555102
2024-12-22 23:53:07,920 - INFO - Logged log_loss: 0.49898358702783896
2024-12-22 23:53:07,926 - INFO - Logged brier_score: 0.16524634839687835
2024-12-22 23:53:07,926 - INFO - Logging artifacts...
2024-12-22 23:53:08,375 - INFO - Model evaluation completed in 0.62 seconds
2024-12-22 23:53:11,913 - INFO - Model LogisticRegression evaluated with params {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}, threshold 0.5, scoring f1.
2024-12-22 23:53:11,938 - INFO -                 model  decision_threshold  ...                                        best_params                                     feature_params
0        RandomForest                 0.5  ...  {'classifier__n_estimators': 300, 'classifier_...  {'variance_threshold': 0.01, 'importance_thres...
1             XGBoost                 0.5  ...  {'classifier__subsample': 0.5, 'classifier__n_...  {'variance_threshold': 0.01, 'importance_thres...
2            LightGBM                 0.5  ...  {'classifier__num_leaves': 31, 'classifier__n_...  {'variance_threshold': 0.01, 'importance_thres...
3  LogisticRegression                 0.5  ...  {'classifier__solver': 'liblinear', 'classifie...  {'variance_threshold': 0.01, 'importance_thres...

[4 rows x 6 columns]
2024-12-22 23:53:26,910 - INFO - Loading data from ../data/processed/merged_data_2019_2022.csv
2024-12-22 23:53:29,704 - INFO - Data loaded successfully
2024-12-22 23:53:30,265 - INFO - Building pipeline for RandomForestClassifier()...
2024-12-22 23:53:30,265 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-22 23:53:30,339 - INFO - Identifying column types...
2024-12-22 23:53:30,347 - DEBUG - Numerical columns detected: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:53:30,347 - DEBUG - Categorical columns detected: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:53:30,468 - INFO - Building preprocessor...
2024-12-22 23:53:30,468 - DEBUG - Numerical columns: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:53:30,468 - DEBUG - Categorical columns: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:53:30,473 - INFO - Preprocessor built successfully.
2024-12-22 23:53:30,503 - INFO - Pipeline built successfully.
2024-12-22 23:53:30,679 - INFO - Starting model training for RandomForest...
2024-12-22 23:54:02,437 - INFO - Training completed in 31.76 seconds
2024-12-22 23:54:02,437 - INFO - Best parameters: {'classifier__n_estimators': 300, 'classifier__min_samples_split': 10, 'classifier__min_samples_leaf': 1, 'classifier__max_depth': None, 'classifier__class_weight': 'balanced'}
2024-12-22 23:54:07,086 - INFO - Evaluating model: RandomForest
2024-12-22 23:54:07,527 - INFO - Calculating metrics...
2024-12-22 23:54:07,536 - INFO - F1-score: 0.7779
2024-12-22 23:54:07,536 - INFO - Cohen Kappa: 0.4032
2024-12-22 23:54:07,536 - INFO - MCC: 0.4524
2024-12-22 23:54:07,536 - INFO - Recall: 0.7514
2024-12-22 23:54:07,536 - INFO - Balanced Accuracy: 0.7838
2024-12-22 23:54:07,542 - INFO - ROC AUC: 0.8574
2024-12-22 23:54:07,542 - INFO - Log Loss: 0.4830
2024-12-22 23:54:07,542 - INFO - Brier Score: 0.1615
2024-12-22 23:54:07,542 - INFO - Logging metrics to MLflow...
2024-12-22 23:54:07,547 - INFO - Logged f1_score: 0.7778672824868414
2024-12-22 23:54:07,553 - INFO - Logged cohen_kappa: 0.4032314770816996
2024-12-22 23:54:07,558 - INFO - Logged mcc: 0.4524116121512735
2024-12-22 23:54:07,564 - INFO - Logged recall: 0.7513711151736746
2024-12-22 23:54:07,569 - INFO - Logged balanced_accuracy: 0.7838325024691695
2024-12-22 23:54:07,574 - INFO - Logged roc_auc: 0.8574250479473408
2024-12-22 23:54:07,580 - INFO - Logged log_loss: 0.4829881544637607
2024-12-22 23:54:07,585 - INFO - Logged brier_score: 0.1614701179219239
2024-12-22 23:54:07,585 - INFO - Logging artifacts...
2024-12-22 23:54:08,081 - INFO - Model evaluation completed in 1.00 seconds
2024-12-22 23:54:11,506 - INFO - Model RandomForest evaluated with params {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}, threshold 0.5, scoring f1.
2024-12-22 23:54:11,670 - INFO - Building pipeline for XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=None,
              num_parallel_tree=None, random_state=None, ...)...
2024-12-22 23:54:11,670 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-22 23:54:11,746 - INFO - Identifying column types...
2024-12-22 23:54:11,761 - DEBUG - Numerical columns detected: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:54:11,761 - DEBUG - Categorical columns detected: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:54:11,879 - INFO - Building preprocessor...
2024-12-22 23:54:11,879 - DEBUG - Numerical columns: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:54:11,879 - DEBUG - Categorical columns: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:54:11,885 - INFO - Preprocessor built successfully.
2024-12-22 23:54:11,915 - INFO - Pipeline built successfully.
2024-12-22 23:54:12,085 - INFO - Starting model training for XGBoost...
2024-12-22 23:54:29,595 - INFO - Training completed in 17.51 seconds
2024-12-22 23:54:29,595 - INFO - Best parameters: {'classifier__subsample': 0.5, 'classifier__n_estimators': 100, 'classifier__max_depth': 6, 'classifier__learning_rate': 0.1, 'classifier__colsample_bytree': 0.5, 'classifier__class_weight': {'0': 1, '1': 5}}
2024-12-22 23:54:33,337 - INFO - Evaluating model: XGBoost
2024-12-22 23:54:33,441 - INFO - Calculating metrics...
2024-12-22 23:54:33,456 - INFO - F1-score: 0.7811
2024-12-22 23:54:33,456 - INFO - Cohen Kappa: 0.4026
2024-12-22 23:54:33,456 - INFO - MCC: 0.4466
2024-12-22 23:54:33,456 - INFO - Recall: 0.7557
2024-12-22 23:54:33,456 - INFO - Balanced Accuracy: 0.7782
2024-12-22 23:54:33,465 - INFO - ROC AUC: 0.8572
2024-12-22 23:54:33,465 - INFO - Log Loss: 0.4794
2024-12-22 23:54:33,466 - INFO - Brier Score: 0.1602
2024-12-22 23:54:33,466 - INFO - Logging metrics to MLflow...
2024-12-22 23:54:33,475 - INFO - Logged f1_score: 0.7811088293607148
2024-12-22 23:54:33,484 - INFO - Logged cohen_kappa: 0.4026434650570482
2024-12-22 23:54:33,493 - INFO - Logged mcc: 0.44655461133327734
2024-12-22 23:54:33,503 - INFO - Logged recall: 0.7557383709120455
2024-12-22 23:54:33,512 - INFO - Logged balanced_accuracy: 0.7781661696725193
2024-12-22 23:54:33,521 - INFO - Logged roc_auc: 0.857160598634888
2024-12-22 23:54:33,529 - INFO - Logged log_loss: 0.4793667157101297
2024-12-22 23:54:33,538 - INFO - Logged brier_score: 0.16016963764687003
2024-12-22 23:54:33,538 - INFO - Logging artifacts...
2024-12-22 23:54:33,884 - INFO - Model evaluation completed in 0.55 seconds
2024-12-22 23:54:37,511 - INFO - Model XGBoost evaluated with params {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}, threshold 0.5, scoring f1.
2024-12-22 23:54:37,672 - INFO - Building pipeline for LGBMClassifier()...
2024-12-22 23:54:37,672 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-22 23:54:37,746 - INFO - Identifying column types...
2024-12-22 23:54:37,763 - DEBUG - Numerical columns detected: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:54:37,763 - DEBUG - Categorical columns detected: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:54:37,883 - INFO - Building preprocessor...
2024-12-22 23:54:37,883 - DEBUG - Numerical columns: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:54:37,883 - DEBUG - Categorical columns: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:54:37,888 - INFO - Preprocessor built successfully.
2024-12-22 23:54:37,917 - INFO - Pipeline built successfully.
2024-12-22 23:54:38,075 - INFO - Starting model training for LightGBM...
2024-12-22 23:54:57,901 - INFO - Training completed in 19.83 seconds
2024-12-22 23:54:57,901 - INFO - Best parameters: {'classifier__num_leaves': 31, 'classifier__n_estimators': 100, 'classifier__max_depth': -1, 'classifier__learning_rate': 0.1, 'classifier__class_weight': 'balanced'}
2024-12-22 23:55:01,481 - INFO - Evaluating model: LightGBM
2024-12-22 23:55:01,562 - INFO - Calculating metrics...
2024-12-22 23:55:01,571 - INFO - F1-score: 0.7780
2024-12-22 23:55:01,571 - INFO - Cohen Kappa: 0.4020
2024-12-22 23:55:01,571 - INFO - MCC: 0.4501
2024-12-22 23:55:01,571 - INFO - Recall: 0.7517
2024-12-22 23:55:01,571 - INFO - Balanced Accuracy: 0.7820
2024-12-22 23:55:01,576 - INFO - ROC AUC: 0.8571
2024-12-22 23:55:01,576 - INFO - Log Loss: 0.4816
2024-12-22 23:55:01,576 - INFO - Brier Score: 0.1616
2024-12-22 23:55:01,576 - INFO - Logging metrics to MLflow...
2024-12-22 23:55:01,581 - INFO - Logged f1_score: 0.7780283175887579
2024-12-22 23:55:01,587 - INFO - Logged cohen_kappa: 0.4020071183436429
2024-12-22 23:55:01,593 - INFO - Logged mcc: 0.45010536057122497
2024-12-22 23:55:01,599 - INFO - Logged recall: 0.7516758074344911
2024-12-22 23:55:01,604 - INFO - Logged balanced_accuracy: 0.7820452475666619
2024-12-22 23:55:01,612 - INFO - Logged roc_auc: 0.8570996710748291
2024-12-22 23:55:01,618 - INFO - Logged log_loss: 0.48157406888929005
2024-12-22 23:55:01,624 - INFO - Logged brier_score: 0.16163627885221513
2024-12-22 23:55:01,624 - INFO - Logging artifacts...
2024-12-22 23:55:01,909 - INFO - Model evaluation completed in 0.43 seconds
2024-12-22 23:55:05,817 - INFO - Model LightGBM evaluated with params {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}, threshold 0.5, scoring f1.
2024-12-22 23:55:06,008 - INFO - Building pipeline for LogisticRegression()...
2024-12-22 23:55:06,008 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-22 23:55:06,098 - INFO - Identifying column types...
2024-12-22 23:55:06,116 - DEBUG - Numerical columns detected: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:55:06,116 - DEBUG - Categorical columns detected: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:55:06,250 - INFO - Building preprocessor...
2024-12-22 23:55:06,250 - DEBUG - Numerical columns: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-22 23:55:06,250 - DEBUG - Categorical columns: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-22 23:55:06,256 - INFO - Preprocessor built successfully.
2024-12-22 23:55:06,287 - INFO - Pipeline built successfully.
2024-12-22 23:55:06,463 - INFO - Starting model training for LogisticRegression...
2024-12-22 23:55:23,018 - INFO - Training completed in 16.55 seconds
2024-12-22 23:55:23,018 - INFO - Best parameters: {'classifier__solver': 'liblinear', 'classifier__penalty': 'l2', 'classifier__class_weight': 'balanced', 'classifier__C': 0.1}
2024-12-22 23:55:26,301 - INFO - Evaluating model: LogisticRegression
2024-12-22 23:55:26,365 - INFO - Calculating metrics...
2024-12-22 23:55:26,376 - INFO - F1-score: 0.7767
2024-12-22 23:55:26,376 - INFO - Cohen Kappa: 0.3832
2024-12-22 23:55:26,376 - INFO - MCC: 0.4213
2024-12-22 23:55:26,376 - INFO - Recall: 0.7515
2024-12-22 23:55:26,376 - INFO - Balanced Accuracy: 0.7609
2024-12-22 23:55:26,383 - INFO - ROC AUC: 0.8416
2024-12-22 23:55:26,383 - INFO - Log Loss: 0.4990
2024-12-22 23:55:26,383 - INFO - Brier Score: 0.1652
2024-12-22 23:55:26,383 - INFO - Logging metrics to MLflow...
2024-12-22 23:55:26,391 - INFO - Logged f1_score: 0.7766962849135455
2024-12-22 23:55:26,398 - INFO - Logged cohen_kappa: 0.3832074420732693
2024-12-22 23:55:26,403 - INFO - Logged mcc: 0.42132676782566714
2024-12-22 23:55:26,409 - INFO - Logged recall: 0.7514726792606135
2024-12-22 23:55:26,414 - INFO - Logged balanced_accuracy: 0.7608741055360146
2024-12-22 23:55:26,420 - INFO - Logged roc_auc: 0.8415578103555102
2024-12-22 23:55:26,428 - INFO - Logged log_loss: 0.49898358702783896
2024-12-22 23:55:26,436 - INFO - Logged brier_score: 0.16524634839687835
2024-12-22 23:55:26,437 - INFO - Logging artifacts...
2024-12-22 23:55:26,832 - INFO - Model evaluation completed in 0.53 seconds
2024-12-22 23:55:30,002 - INFO - Model LogisticRegression evaluated with params {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}, threshold 0.5, scoring f1.
2024-12-22 23:55:30,026 - INFO -                 model  decision_threshold  ...                                        best_params                                     feature_params
0        RandomForest                 0.5  ...  {'classifier__n_estimators': 300, 'classifier_...  {'variance_threshold': 0.01, 'importance_thres...
1             XGBoost                 0.5  ...  {'classifier__subsample': 0.5, 'classifier__n_...  {'variance_threshold': 0.01, 'importance_thres...
2            LightGBM                 0.5  ...  {'classifier__num_leaves': 31, 'classifier__n_...  {'variance_threshold': 0.01, 'importance_thres...
3  LogisticRegression                 0.5  ...  {'classifier__solver': 'liblinear', 'classifie...  {'variance_threshold': 0.01, 'importance_thres...

[4 rows x 6 columns]
2024-12-23 00:02:34,000 - INFO - Loading data from ../data/processed/merged_data_2019_2022.csv
2024-12-23 00:02:36,298 - ERROR - Error while loading data.
2024-12-23 00:02:36,298 - ERROR - Exception: The test_size = 1 should be greater or equal to the number of classes = 2
2024-12-23 00:05:20,105 - INFO - Loading data from ../data/processed/merged_data_2019_2022.csv
2024-12-23 00:05:22,817 - INFO - Data loaded successfully
2024-12-23 00:05:23,851 - INFO - Building pipeline for RandomForestClassifier()...
2024-12-23 00:05:23,851 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-23 00:05:23,930 - INFO - Identifying column types...
2024-12-23 00:05:23,999 - DEBUG - Numerical columns detected: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-23 00:05:23,999 - DEBUG - Categorical columns detected: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-23 00:05:24,375 - INFO - Building preprocessor...
2024-12-23 00:05:24,375 - DEBUG - Numerical columns: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-23 00:05:24,375 - DEBUG - Categorical columns: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-23 00:05:24,380 - INFO - Preprocessor built successfully.
2024-12-23 00:05:24,411 - INFO - Pipeline built successfully.
2024-12-23 00:05:24,595 - INFO - Starting model training for RandomForest...
2024-12-23 00:12:30,283 - INFO - Training completed in 425.69 seconds
2024-12-23 00:12:30,283 - INFO - Best parameters: {'classifier__n_estimators': 300, 'classifier__min_samples_split': 10, 'classifier__min_samples_leaf': 1, 'classifier__max_depth': None, 'classifier__class_weight': 'balanced'}
2024-12-23 00:13:07,154 - INFO - Loading data from ../data/processed/merged_data_2019_2022.csv
2024-12-23 00:13:10,091 - INFO - Data loaded successfully
2024-12-23 00:13:11,103 - INFO - Building pipeline for RandomForestClassifier()...
2024-12-23 00:13:11,103 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-23 00:13:11,179 - INFO - Identifying column types...
2024-12-23 00:13:11,245 - DEBUG - Numerical columns detected: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-23 00:13:11,245 - DEBUG - Categorical columns detected: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-23 00:13:11,542 - INFO - Building preprocessor...
2024-12-23 00:13:11,542 - DEBUG - Numerical columns: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-23 00:13:11,542 - DEBUG - Categorical columns: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-23 00:13:11,547 - INFO - Preprocessor built successfully.
2024-12-23 00:13:11,578 - INFO - Pipeline built successfully.
2024-12-23 00:13:11,742 - INFO - Starting model training for RandomForest...
2024-12-23 00:16:02,069 - INFO - Loading data from ../data/processed/merged_data_2019_2022.csv
2024-12-23 00:16:04,833 - INFO - Data loaded successfully
2024-12-23 00:16:05,817 - INFO - Building pipeline for RandomForestClassifier()...
2024-12-23 00:16:05,817 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-23 00:16:05,894 - INFO - Identifying column types...
2024-12-23 00:16:05,960 - DEBUG - Numerical columns detected: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-23 00:16:05,960 - DEBUG - Categorical columns detected: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-23 00:16:06,244 - INFO - Building preprocessor...
2024-12-23 00:16:06,244 - DEBUG - Numerical columns: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-23 00:16:06,244 - DEBUG - Categorical columns: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-23 00:16:06,248 - INFO - Preprocessor built successfully.
2024-12-23 00:16:06,279 - INFO - Pipeline built successfully.
2024-12-23 00:16:06,446 - INFO - Starting model training for RandomForest...
2024-12-23 00:17:16,594 - INFO - Loading data from ../data/processed/merged_data_2019_2022.csv
2024-12-23 00:17:19,575 - INFO - Data loaded successfully
2024-12-23 00:17:20,772 - INFO - Building pipeline for RandomForestClassifier()...
2024-12-23 00:17:20,772 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-23 00:17:20,858 - INFO - Identifying column types...
2024-12-23 00:17:20,925 - DEBUG - Numerical columns detected: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-23 00:17:20,925 - DEBUG - Categorical columns detected: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-23 00:17:21,224 - INFO - Building preprocessor...
2024-12-23 00:17:21,224 - DEBUG - Numerical columns: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-23 00:17:21,224 - DEBUG - Categorical columns: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-23 00:17:21,229 - INFO - Preprocessor built successfully.
2024-12-23 00:17:21,261 - INFO - Pipeline built successfully.
2024-12-23 00:17:21,418 - INFO - Starting model training for RandomForest...
2024-12-23 00:24:12,896 - INFO - Training completed in 411.48 seconds
2024-12-23 00:24:12,897 - INFO - Best parameters: {'classifier__n_estimators': 300, 'classifier__min_samples_split': 10, 'classifier__min_samples_leaf': 1, 'classifier__max_depth': None, 'classifier__class_weight': 'balanced'}
2024-12-23 00:24:20,167 - INFO - Evaluating model: RandomForest
2024-12-23 00:24:31,530 - INFO - Calculating metrics...
2024-12-23 00:24:31,719 - INFO - F1-score: 0.7923
2024-12-23 00:24:31,719 - INFO - Cohen Kappa: 0.4289
2024-12-23 00:24:31,719 - INFO - MCC: 0.4731
2024-12-23 00:24:31,719 - INFO - Recall: 0.7686
2024-12-23 00:24:31,719 - INFO - Balanced Accuracy: 0.7936
2024-12-23 00:24:31,791 - INFO - ROC AUC: 0.8700
2024-12-23 00:24:31,791 - INFO - Log Loss: 0.4618
2024-12-23 00:24:31,791 - INFO - Brier Score: 0.1531
2024-12-23 00:24:31,791 - INFO - Logging metrics to MLflow...
2024-12-23 00:24:31,798 - INFO - Logged f1_score: 0.792290210523871
2024-12-23 00:24:31,803 - INFO - Logged cohen_kappa: 0.42891447862193377
2024-12-23 00:24:31,810 - INFO - Logged mcc: 0.47313879908113493
2024-12-23 00:24:31,816 - INFO - Logged recall: 0.7685853876547725
2024-12-23 00:24:31,822 - INFO - Logged balanced_accuracy: 0.7936496572817421
2024-12-23 00:24:31,829 - INFO - Logged roc_auc: 0.8700235219020642
2024-12-23 00:24:31,835 - INFO - Logged log_loss: 0.46181795538482323
2024-12-23 00:24:31,842 - INFO - Logged brier_score: 0.15305613746260838
2024-12-23 00:24:31,842 - INFO - Logging artifacts...
2024-12-23 00:24:36,902 - INFO - Model evaluation completed in 16.73 seconds
2024-12-23 00:24:42,496 - INFO - Model RandomForest evaluated with params {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}, threshold 0.5, scoring f1.
2024-12-23 00:24:42,704 - INFO - Building pipeline for XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=None,
              num_parallel_tree=None, random_state=None, ...)...
2024-12-23 00:24:42,704 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-23 00:24:42,799 - INFO - Identifying column types...
2024-12-23 00:24:42,975 - DEBUG - Numerical columns detected: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-23 00:24:42,975 - DEBUG - Categorical columns detected: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-23 00:24:43,457 - INFO - Building preprocessor...
2024-12-23 00:24:43,458 - DEBUG - Numerical columns: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-23 00:24:43,458 - DEBUG - Categorical columns: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-23 00:24:43,466 - INFO - Preprocessor built successfully.
2024-12-23 00:24:43,500 - INFO - Pipeline built successfully.
2024-12-23 00:24:43,707 - INFO - Starting model training for XGBoost...
2024-12-23 00:27:54,486 - INFO - Loading data from ../data/processed/merged_data_2019_2022.csv
2024-12-23 00:27:58,170 - INFO - Data loaded successfully
2024-12-23 00:27:59,695 - INFO - Building pipeline for RandomForestClassifier()...
2024-12-23 00:27:59,695 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-23 00:27:59,797 - INFO - Identifying column types...
2024-12-23 00:27:59,883 - DEBUG - Numerical columns detected: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-23 00:27:59,883 - DEBUG - Categorical columns detected: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-23 00:28:00,234 - INFO - Building preprocessor...
2024-12-23 00:28:00,234 - DEBUG - Numerical columns: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-23 00:28:00,234 - DEBUG - Categorical columns: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-23 00:28:00,240 - INFO - Preprocessor built successfully.
2024-12-23 00:28:00,274 - INFO - Pipeline built successfully.
2024-12-23 00:28:00,474 - INFO - Starting model training for RandomForest...
2024-12-23 00:38:33,846 - INFO - Training completed in 633.37 seconds
2024-12-23 00:38:33,847 - INFO - Best parameters: {'classifier__n_estimators': 500, 'classifier__min_samples_split': 2, 'classifier__min_samples_leaf': 1, 'classifier__max_depth': None, 'classifier__class_weight': 'balanced'}
2024-12-23 00:39:22,942 - INFO - Evaluating model: RandomForest
2024-12-23 00:39:35,772 - INFO - Calculating metrics...
2024-12-23 00:39:35,957 - INFO - F1-score: 0.7929
2024-12-23 00:39:35,957 - INFO - Cohen Kappa: 0.4296
2024-12-23 00:39:35,958 - INFO - MCC: 0.4734
2024-12-23 00:39:35,958 - INFO - Recall: 0.7693
2024-12-23 00:39:35,958 - INFO - Balanced Accuracy: 0.7936
2024-12-23 00:39:36,030 - INFO - ROC AUC: 0.8701
2024-12-23 00:39:36,030 - INFO - Log Loss: 0.4611
2024-12-23 00:39:36,030 - INFO - Brier Score: 0.1526
2024-12-23 00:39:36,030 - INFO - Logging metrics to MLflow...
2024-12-23 00:39:36,035 - INFO - Logged f1_score: 0.7928750385207658
2024-12-23 00:39:36,041 - INFO - Logged cohen_kappa: 0.42964150691925285
2024-12-23 00:39:36,047 - INFO - Logged mcc: 0.47341611921586246
2024-12-23 00:39:36,053 - INFO - Logged recall: 0.7693167159297518
2024-12-23 00:39:36,058 - INFO - Logged balanced_accuracy: 0.7935915871149413
2024-12-23 00:39:36,064 - INFO - Logged roc_auc: 0.8701496597632569
2024-12-23 00:39:36,070 - INFO - Logged log_loss: 0.4610551944196977
2024-12-23 00:39:36,076 - INFO - Logged brier_score: 0.15258810347714988
2024-12-23 00:39:36,077 - INFO - Logging artifacts...
2024-12-23 00:39:41,486 - INFO - Model evaluation completed in 18.54 seconds
2024-12-23 00:40:23,896 - INFO - Model RandomForest evaluated with params {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}, threshold 0.5, scoring f1.
2024-12-23 00:40:24,095 - INFO - Building pipeline for XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=None,
              num_parallel_tree=None, random_state=None, ...)...
2024-12-23 00:40:24,095 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-23 00:40:24,190 - INFO - Identifying column types...
2024-12-23 00:40:24,373 - DEBUG - Numerical columns detected: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-23 00:40:24,373 - DEBUG - Categorical columns detected: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-23 00:40:24,709 - INFO - Building preprocessor...
2024-12-23 00:40:24,709 - DEBUG - Numerical columns: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-23 00:40:24,709 - DEBUG - Categorical columns: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-23 00:40:24,715 - INFO - Preprocessor built successfully.
2024-12-23 00:40:24,745 - INFO - Pipeline built successfully.
2024-12-23 00:40:24,938 - INFO - Starting model training for XGBoost...
2024-12-23 00:44:18,256 - INFO - Training completed in 233.32 seconds
2024-12-23 00:44:18,256 - INFO - Best parameters: {'classifier__subsample': 1.0, 'classifier__n_estimators': 300, 'classifier__max_depth': 6, 'classifier__learning_rate': 0.1, 'classifier__colsample_bytree': 0.5, 'classifier__class_weight': 'balanced'}
2024-12-23 00:44:25,540 - INFO - Evaluating model: XGBoost
2024-12-23 00:44:26,243 - INFO - Calculating metrics...
2024-12-23 00:44:26,301 - INFO - F1-score: 0.7928
2024-12-23 00:44:26,301 - INFO - Cohen Kappa: 0.4287
2024-12-23 00:44:26,301 - INFO - MCC: 0.4719
2024-12-23 00:44:26,301 - INFO - Recall: 0.7693
2024-12-23 00:44:26,301 - INFO - Balanced Accuracy: 0.7925
2024-12-23 00:44:26,379 - INFO - ROC AUC: 0.8705
2024-12-23 00:44:26,379 - INFO - Log Loss: 0.4580
2024-12-23 00:44:26,379 - INFO - Brier Score: 0.1526
2024-12-23 00:44:26,379 - INFO - Logging metrics to MLflow...
2024-12-23 00:44:26,384 - INFO - Logged f1_score: 0.7927723217718549
2024-12-23 00:44:26,390 - INFO - Logged cohen_kappa: 0.42866346129508204
2024-12-23 00:44:26,396 - INFO - Logged mcc: 0.4719275812393437
2024-12-23 00:44:26,402 - INFO - Logged recall: 0.7692659292439894
2024-12-23 00:44:26,408 - INFO - Logged balanced_accuracy: 0.7924861852032249
2024-12-23 00:44:26,414 - INFO - Logged roc_auc: 0.8704909552116522
2024-12-23 00:44:26,420 - INFO - Logged log_loss: 0.45797227754092085
2024-12-23 00:44:26,426 - INFO - Logged brier_score: 0.15260148272953789
2024-12-23 00:44:26,426 - INFO - Logging artifacts...
2024-12-23 00:44:26,918 - INFO - Model evaluation completed in 1.38 seconds
2024-12-23 00:44:30,420 - INFO - Model XGBoost evaluated with params {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}, threshold 0.5, scoring f1.
2024-12-23 00:44:30,891 - INFO - Building pipeline for LGBMClassifier()...
2024-12-23 00:44:30,891 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-23 00:44:30,976 - INFO - Identifying column types...
2024-12-23 00:44:31,141 - DEBUG - Numerical columns detected: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-23 00:44:31,141 - DEBUG - Categorical columns detected: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-23 00:44:31,464 - INFO - Building preprocessor...
2024-12-23 00:44:31,464 - DEBUG - Numerical columns: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-23 00:44:31,464 - DEBUG - Categorical columns: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-23 00:44:31,470 - INFO - Preprocessor built successfully.
2024-12-23 00:44:31,501 - INFO - Pipeline built successfully.
2024-12-23 00:44:31,671 - INFO - Starting model training for LightGBM...
2024-12-23 00:48:48,103 - INFO - Training completed in 256.43 seconds
2024-12-23 00:48:48,103 - INFO - Best parameters: {'classifier__num_leaves': 100, 'classifier__n_estimators': 100, 'classifier__max_depth': 20, 'classifier__learning_rate': 0.1, 'classifier__class_weight': 'balanced'}
2024-12-23 00:48:52,138 - INFO - Evaluating model: LightGBM
2024-12-23 00:48:53,106 - INFO - Calculating metrics...
2024-12-23 00:48:53,157 - INFO - F1-score: 0.7914
2024-12-23 00:48:53,157 - INFO - Cohen Kappa: 0.4260
2024-12-23 00:48:53,157 - INFO - MCC: 0.4697
2024-12-23 00:48:53,157 - INFO - Recall: 0.7676
2024-12-23 00:48:53,157 - INFO - Balanced Accuracy: 0.7914
2024-12-23 00:48:53,234 - INFO - ROC AUC: 0.8698
2024-12-23 00:48:53,234 - INFO - Log Loss: 0.4592
2024-12-23 00:48:53,234 - INFO - Brier Score: 0.1531
2024-12-23 00:48:53,234 - INFO - Logging metrics to MLflow...
2024-12-23 00:48:53,243 - INFO - Logged f1_score: 0.7913675361814414
2024-12-23 00:48:53,254 - INFO - Logged cohen_kappa: 0.42601679017462724
2024-12-23 00:48:53,264 - INFO - Logged mcc: 0.4697304187076547
2024-12-23 00:48:53,274 - INFO - Logged recall: 0.7675899686138282
2024-12-23 00:48:53,283 - INFO - Logged balanced_accuracy: 0.7914416114330198
2024-12-23 00:48:53,295 - INFO - Logged roc_auc: 0.8697899642204047
2024-12-23 00:48:53,306 - INFO - Logged log_loss: 0.45924627340780566
2024-12-23 00:48:53,321 - INFO - Logged brier_score: 0.1531317252286399
2024-12-23 00:48:53,322 - INFO - Logging artifacts...
2024-12-23 00:48:54,144 - INFO - Model evaluation completed in 2.01 seconds
2024-12-23 00:48:58,865 - INFO - Model LightGBM evaluated with params {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}, threshold 0.5, scoring f1.
2024-12-23 00:48:59,083 - INFO - Building pipeline for LogisticRegression()...
2024-12-23 00:48:59,083 - DEBUG - Feature selector parameters: {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}
2024-12-23 00:48:59,175 - INFO - Identifying column types...
2024-12-23 00:48:59,351 - DEBUG - Numerical columns detected: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-23 00:48:59,351 - DEBUG - Categorical columns detected: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-23 00:48:59,722 - INFO - Building preprocessor...
2024-12-23 00:48:59,722 - DEBUG - Numerical columns: ['an_nais', 'jour', 'mois', 'agg', 'vma', 'nb_v', 'nb_u', 'hr', 'tpc', 'has_ceinture', 'has_gants', 'has_casque', 'has_airbag', 'has_gilet', 'has_de', 'choc_avant', 'choc_arriere', 'choc_gauche', 'choc_droit']
2024-12-23 00:48:59,722 - DEBUG - Categorical columns: ['place', 'catu', 'sexe', 'trajet', 'locp', 'actp', 'senc', 'catv', 'obs', 'obsm', 'manv', 'lum', 'int', 'atm', 'col', 'catr', 'circ', 'vosp', 'prof', 'plan', 'surf', 'infra', 'situ', 'jour_semaine', 'reg']
2024-12-23 00:48:59,728 - INFO - Preprocessor built successfully.
2024-12-23 00:48:59,771 - INFO - Pipeline built successfully.
2024-12-23 00:48:59,985 - INFO - Starting model training for LogisticRegression...
2024-12-23 00:53:11,224 - INFO - Training completed in 251.24 seconds
2024-12-23 00:53:11,224 - INFO - Best parameters: {'classifier__solver': 'liblinear', 'classifier__penalty': 'l2', 'classifier__class_weight': 'balanced', 'classifier__C': 1}
2024-12-23 00:53:15,504 - INFO - Evaluating model: LogisticRegression
2024-12-23 00:53:16,139 - INFO - Calculating metrics...
2024-12-23 00:53:16,167 - INFO - F1-score: 0.7779
2024-12-23 00:53:16,167 - INFO - Cohen Kappa: 0.3886
2024-12-23 00:53:16,167 - INFO - MCC: 0.4282
2024-12-23 00:53:16,167 - INFO - Recall: 0.7526
2024-12-23 00:53:16,167 - INFO - Balanced Accuracy: 0.7656
2024-12-23 00:53:16,204 - INFO - ROC AUC: 0.8427
2024-12-23 00:53:16,204 - INFO - Log Loss: 0.4999
2024-12-23 00:53:16,204 - INFO - Brier Score: 0.1656
2024-12-23 00:53:16,204 - INFO - Logging metrics to MLflow...
2024-12-23 00:53:16,212 - INFO - Logged f1_score: 0.7779032629004917
2024-12-23 00:53:16,219 - INFO - Logged cohen_kappa: 0.38856599216520393
2024-12-23 00:53:16,225 - INFO - Logged mcc: 0.428231823554811
2024-12-23 00:53:16,232 - INFO - Logged recall: 0.7526282109882073
2024-12-23 00:53:16,241 - INFO - Logged balanced_accuracy: 0.765603950505823
2024-12-23 00:53:16,247 - INFO - Logged roc_auc: 0.8426632905486287
2024-12-23 00:53:16,253 - INFO - Logged log_loss: 0.4999230408347425
2024-12-23 00:53:16,259 - INFO - Logged brier_score: 0.16564813173849127
2024-12-23 00:53:16,259 - INFO - Logging artifacts...
2024-12-23 00:53:16,798 - INFO - Model evaluation completed in 1.29 seconds
2024-12-23 00:53:20,494 - INFO - Model LogisticRegression evaluated with params {'variance_threshold': 0.01, 'importance_threshold': 0.01, 'correlation_threshold': 0.9}, threshold 0.5, scoring f1.
2024-12-23 00:53:20,659 - INFO -                 model  decision_threshold  ...                                        best_params                                     feature_params
0        RandomForest                 0.5  ...  {'classifier__n_estimators': 500, 'classifier_...  {'variance_threshold': 0.01, 'importance_thres...
1             XGBoost                 0.5  ...  {'classifier__subsample': 1.0, 'classifier__n_...  {'variance_threshold': 0.01, 'importance_thres...
2            LightGBM                 0.5  ...  {'classifier__num_leaves': 100, 'classifier__n...  {'variance_threshold': 0.01, 'importance_thres...
3  LogisticRegression                 0.5  ...  {'classifier__solver': 'liblinear', 'classifie...  {'variance_threshold': 0.01, 'importance_thres...

[4 rows x 6 columns]
